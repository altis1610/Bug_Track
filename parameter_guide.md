# 昆蟲追蹤參數指南

本指南解釋了每種追蹤方法的所有可調參數，它們對追蹤性能的影響，以及推薦的取值範圍。使用本指南可以針對您的特定視頻條件優化追蹤效果。

## 通用參數

### `max_targets`（所有方法）
- **描述**：同時追蹤的昆蟲最大數量。
- **推薦範圍**：1-20
- **增加效果**：可以追蹤更多昆蟲，但在複雜場景中可能引入假陽性。
- **減少效果**：追蹤的昆蟲更少，提高被追蹤昆蟲的可靠性。
- **何時調整**：當畫面中有多隻昆蟲時增加。當您只想關注最明顯的運動時減少。

## 方法一：稀疏光流參數

### `maxCorners`
- **描述**：用於追蹤的角點最大檢測數量。
- **推薦範圍**：10-300
- **增加效果**：更多潛在追蹤點，適合複雜紋理，但可能追蹤雜訊。
- **減少效果**：更少追蹤點，專注於強角點，可能會錯過細微昆蟲。
- **何時調整**：對於非常小的昆蟲或檢測不到時增加。對於大型昆蟲或有雜訊的視頻減少。

### `qualityLevel`
- **描述**：角點檢測的最小質量閾值（相對於最佳角點）。
- **推薦範圍**：0.01-0.5
- **增加效果**：更具選擇性的角點檢測，只有強角點被保留。
- **減少效果**：檢測到更多角點，包括較弱的角點。
- **何時調整**：在高對比度場景中增加。當昆蟲對比度低或體型小時減少。

### `minDistance`
- **描述**：檢測到的角點之間的最小像素距離。
- **推薦範圍**：3-20
- **增加效果**：角點空間分佈更分散，防止聚集。
- **減少效果**：允許角點更靠近，適合小型昆蟲。
- **何時調整**：對於較大的昆蟲增加。對於特徵緊密的小型昆蟲減少。

### `blockSize`
- **描述**：角點檢測的窗口大小。
- **推薦範圍**：3-15（必須是奇數）
- **增加效果**：考慮更大的鄰域，檢測更平滑但精度較低。
- **減少效果**：更精確的局部角點檢測，適合小細節。
- **何時調整**：對於有雜訊的視頻或較大的昆蟲增加。對於小特徵或高解析度視頻減少。

### `winSize`
- **描述**：光流計算的搜索窗口大小。
- **推薦範圍**：(5,5)到(31,31)（必須是奇數）
- **增加效果**：追蹤幀間較大的運動，但精度較低。
- **減少效果**：更精確地追蹤小運動。
- **何時調整**：對於快速移動的昆蟲或低幀率視頻增加。對於慢速運動或高幀率減少。

### `maxLevel`
- **描述**：光流計算的最大金字塔層級。
- **推薦範圍**：0-5
- **增加效果**：更好地追蹤大運動，但處理速度較慢。
- **減少效果**：處理更快，但可能失去對快速運動的追蹤。
- **何時調整**：對於快速移動的昆蟲增加。對於慢速移動的昆蟲或當性能重要時減少。

### `diff_thresh_value`
- **描述**：幀差分檢測運動的閾值。
- **推薦範圍**：10-50
- **增加效果**：對細微運動不太敏感，減少雜訊。
- **減少效果**：對細微運動更敏感，但可能拾取雜訊。
- **何時調整**：在有雜訊的視頻或追蹤大型昆蟲時增加。對於細微、低對比度的運動減少。

## 方法二：密集光流參數

### `mag_thresh`
- **描述**：被視為顯著的最小運動幅度閾值。
- **推薦範圍**：0.5-10.0
- **增加效果**：只檢測到較強的運動，減少假陽性。
- **減少效果**：對細微運動更敏感，可能檢測到相機雜訊。
- **何時調整**：在有雜訊的視頻或不穩定的相機條件下增加。對於細微的昆蟲運動減少。

### `min_area`
- **描述**：被視為有效昆蟲的最小輪廓面積（以像素為單位）。
- **推薦範圍**：10-200
- **增加效果**：只檢測到較大的移動物體，過濾小雜訊。
- **減少效果**：檢測到較小的運動區域，適合微小昆蟲。
- **何時調整**：增加以過濾小雜訊。減少以檢測非常小的昆蟲。

### `pyr_scale`
- **描述**：光流中建立金字塔的圖像縮放因子（<1）。
- **推薦範圍**：0.1-0.9
- **增加效果**：較粗的金字塔層級，更快但精度較低。
- **減少效果**：較細的金字塔層級，更精確但較慢。
- **何時調整**：增加（接近0.9）以獲得更好的性能。減少（接近0.1）以獲得更好的精度。

### `levels`
- **描述**：光流的金字塔層數。
- **推薦範圍**：1-10
- **增加效果**：更好地處理大運動，但較慢。
- **減少效果**：處理更快，但可能錯過大運動。
- **何時調整**：對於非常快的昆蟲運動增加。對於細微、緩慢的運動或當速度至關重要時減少。

### `winsize`
- **描述**：光流計算的窗口大小。
- **推薦範圍**：5-31（必須是奇數）
- **增加效果**：考慮更大的區域，適合較大運動但精度較低。
- **減少效果**：更精確的流計算，但更容易受雜訊影響。
- **何時調整**：對於較大或較快的昆蟲增加。對於具有細微運動的小型昆蟲減少。

### `iterations`
- **描述**：光流計算的迭代次數。
- **推薦範圍**：1-10
- **增加效果**：更精確的流計算，但處理較慢。
- **減少效果**：處理更快，但可能精度較低。
- **何時調整**：為了更精確的追蹤增加。當性能是考慮因素時減少。

### `poly_n`
- **描述**：多項式展開的像素鄰域大小。
- **推薦範圍**：3-9（必須是奇數）
- **增加效果**：更平滑的流場，適合較大的運動模式。
- **減少效果**：更詳細的流場，適合小細節。
- **何時調整**：對於較大的昆蟲或當流場有雜訊時增加。對於具有精細細節的小型昆蟲減少。

### `poly_sigma`
- **描述**：多項式展開的高斯標準差。
- **推薦範圍**：0.5-2.0
- **增加效果**：更平滑的流場，減少雜訊但可能模糊細節。
- **減少效果**：更銳利、更詳細的流場，可能更有雜訊。
- **何時調整**：對於有雜訊的視頻增加。對於具有精細細節的高質量視頻減少。

## 方法三：背景減除參數

### `history`
- **描述**：建立背景模型的幀數。
- **推薦範圍**：50-1000
- **增加效果**：更穩定的背景模型，對變化適應較慢。
- **減少效果**：快速適應背景變化，但可能不太穩定。
- **何時調整**：對於穩定的照明和環境增加。對於變化的背景或照明減少。

### `var_threshold`
- **描述**：背景/前景像素決策的閾值。
- **推薦範圍**：4-64
- **增加效果**：較不敏感，檢測到較少的前景像素，減少雜訊。
- **減少效果**：更敏感，檢測到更多前景像素，可能包括雜訊。
- **何時調整**：增加以減少在有雜訊環境中的誤檢測。減少以檢測低對比度昆蟲。

### `detect_shadows`
- **描述**：是否將陰影檢測並標記為與前景分開。
- **值**：True/False
- **啟用效果**：陰影被單獨檢測，可能減少假陽性。
- **禁用效果**：不特別處理陰影，可能導致陰影被檢測為昆蟲。
- **何時調整**：在有強烈陰影的環境中啟用。當陰影檢測導致問題時禁用。

### `min_area`
- **描述**：被視為有效昆蟲的最小輪廓面積（以像素為單位）。
- **推薦範圍**：10-200
- **增加效果**：只檢測到較大的移動物體，過濾小雜訊。
- **減少效果**：檢測到較小的運動區域，適合微小昆蟲。
- **何時調整**：增加以過濾小雜訊。減少以檢測非常小的昆蟲。

## 方法四：特徵匹配與粒子濾波器參數

### `diff_thresh_value`
- **描述**：幀差分檢測運動的閾值。
- **推薦範圍**：10-50
- **增加效果**：對細微運動不太敏感，減少雜訊。
- **減少效果**：對細微運動更敏感，可能拾取雜訊。
- **何時調整**：在有雜訊的視頻中增加。減少以檢測細微運動。

### `min_area`
- **描述**：被視為有效候選者的最小輪廓面積（以像素為單位）。
- **推薦範圍**：10-200
- **增加效果**：只考慮較大的移動物體，過濾小雜訊。
- **減少效果**：考慮較小的運動區域，適合微小昆蟲。
- **何時調整**：增加以過濾小雜訊。減少以檢測非常小的昆蟲。

### `nfeatures`
- **描述**：用ORB檢測器提取的特徵數量。
- **推薦範圍**：100-2000
- **增加效果**：檢測到更多特徵，適合複雜場景，但較慢。
- **減少效果**：較少特徵，處理更快但可能錯過細節。
- **何時調整**：對於複雜場景或具有細微特徵的小型昆蟲增加。對於簡單場景或當速度重要時減少。

### `feature_match_thresh`
- **描述**：特徵匹配的最大距離閾值。
- **推薦範圍**：10-60
- **增加效果**：更寬容的匹配，適合變形物體。
- **減少效果**：更嚴格的匹配，適合剛性物體，減少誤匹配。
- **何時調整**：對於快速變形的昆蟲或運動模糊增加。對於更剛性的昆蟲減少以獲得更精確的匹配。

### `num_particles`
- **描述**：每個目標的濾波器中的粒子數量。
- **推薦範圍**：50-500
- **增加效果**：更精確的狀態估計，但處理較慢。
- **減少效果**：處理更快，但可能追蹤精度較低。
- **何時調整**：對於難以預測的複雜、不規則運動增加。對於更簡單、更可預測的運動或當性能是考慮因素時減少。

### `particle_std`
- **描述**：初始化中粒子分佈的標準差。
- **推薦範圍**：1.0-20.0
- **增加效果**：粒子分佈更廣，適合不確定的初始位置。
- **減少效果**：粒子聚集更緊密，適合可靠的檢測。
- **何時調整**：當初始檢測不確定時增加。當檢測可靠時減少。

### `process_std`
- **描述**：運動模型中的過程雜訊（標準差）。
- **推薦範圍**：0.5-10.0
- **增加效果**：模型處理更不規則、不可預測的運動。
- **減少效果**：平滑軌跡，假設更可預測的運動。
- **何時調整**：對於不規則、快速變化的昆蟲運動增加。對於更平滑、更可預測的運動減少。

### `measurement_std`
- **描述**：測量雜訊（標準差）。
- **推薦範圍**：1.0-30.0
- **增加效果**：對小測量誤差不太敏感，追蹤更平滑。
- **減少效果**：對測量更敏感，但可能抖動。
- **何時調整**：當檢測有雜訊或不可靠時增加。當檢測精確可靠時減少。

## 推薦參數組合

### 對於非常小、快速的昆蟲